import re
import requests
from pprint import pprint
from bs4 import BeautifulSoup

dictionary = {
    "сингапур": "сингапур",
    "южная корея": "южная-корея",
    "япония": "япония",
    "финляндия": "финляндия",
    "франция": "франция",
    "германия": "германия",
    "испания": "испания",
    "италия": "италия",
    "швеция": "швеция",
    "великобритания": "великобритания",
    "дания": "дания",
    "норвегия": "норвегия",
    "австрия": "австрия",
    "люксембург": "люксембург",
    "нидерланды": "нидерланды",
    "португалия": "португалия",
    "ирландия": "ирландия",
    "швейцария": "швейцария",
    "бельгия": "бельгия",
    "новая зеландия": "новая-зеландия",
    "соединенные штаты америки": "сша",
    "мальта": "мальта",
    "канада": "канада",
    "греция": "греция",
    "австралия": "австралия",
    "чешская республика": "чешская-республика",
    "венгрия": "венгрия",
    "польша": "польша",
    "исландия": "исландия",
    "лихтенштейн": "лихтенштейн",
    "словакия": "словакия",
    "литва": "литва",
    "эстония": "эстония",
    "словения": "словения",
    "латвия": "латвия",
    "малайзия": "малайзия",
    "монако": "монако",
    "кипр": "кипр",
    "румыния": "румыния",
    "болгария": "болгария",
    "чили": "чили",
    "хорватия": "хорватия",
    "сан-марино": "сан-марино",
    "андорра": "андорра",
    "гонконг": "гонконг",
    "аргентина": "аргентина",
    "бразилия": "бразилия",
    "бруней": "бруней",
    "барбадос": "барбадос",
    "израиль": "израиль",
    "багамы": "багамы",
    "мексика": "мексика",
    "сейшелы": "сейшелы",
    "ватикан": "ватикан",
    "сент-китс и невис": "сент-китс-и-невис",
    "уругвай": "уругвай",
    "сент-винсент и гренадины": "сент-винс-гренадины",
    "антигуа и барбуда": "антигуа-и-барбуда",
    "тринидад и тобаго": "тринидад-и-тобаго",
    "коста-рика": "коста-рика",
    "украина": "украина",
    "маврикий": "маврикий",
    "парагвай": "парагвай",
    "тайвань": "тайвань",
    "макао": "макао",
    "доминика": "доминика",
    "сент-люсия": "сент-люсия",
    "гренада": "гренада",
    "панама": "панама",
    "перу": "перу",
    "гондурас": "гондурас",
    "сербия": "сербия",
    "колумбия": "колумбия",
    "сальвадор": "сальвадор",
    "гватемала": "гватемала",
    "соломоновы острова": "соломоновы-острова",
    "самоа": "самоа",
    "никарагуа": "никарагуа",
    "северная македония": "северная-македония",
    "тувалу": "тувалу",
    "черногория": "черногория",
    "тонга": "тонга",
    "молдова": "молдова",
    "кирибати": "кирибати",
    "венесуэла": "венесуэла",
    "маршалловы острова": "маршалловы-острова",
    "палау": "палау",
    "грузия": "грузия",
    "микронезия": "микронезия",
    "албания": "албания",
    "босния и герцеговина": "босния-и-герцеговина",
    "турция": "турция",
    "южная африка": "южная-африка",
    "катар": "катар",
    "белиз": "белиз",
    "кувейт": "кувейт",
    "восточный тимор": "восточный-тимор",
    "эквадор": "эквадор",
    "вануату": "вануату",
    "фиджи": "фиджи",
    "мальдивы": "мальдивы",
    "науру": "науру",
    "бахрейн": "бахрейн",
    "ботсвана": "ботсвана",
    "гайана": "гайана",
    "ямайка": "ямайка",
    "папуа-новая гвинея": "папуа-новая-гвинея",
    "оман": "оман",
    "саудовская аравия": "саудовская-аравия",
    "беларусь": "беларусь",
    "боливия": "боливия",
    "намибия": "намибия",
    "казахстан": "казахстан",
    "суринам": "суринам",
    "таиланд": "таиланд",
    "лесото": "лесото",
    "кения": "кения",
    "эсватини": "эсватини",
    "индонезия": "индонезия",
    "малави": "малави",
    "китай": "китай",
    "танзания": "танзания",
    "замбия": "замбия",
    "доминиканская республика": "доминиканская-респ",
    "тунис": "тунис",
    "азербайджан": "азербайджан",
    "гамбия": "гамбия",
    "армения": "армения",
    "кабо-верде": "кабо-верде",
    "гана": "гана",
    "сьерра-леоне": "сьерра-леоне",
    "уганда": "уганда",
    "зимбабве": "зимбабве",
    "марокко": "марокко",
    "филиппины": "филиппины",
    "руанда": "руанда",
    "киргизия": "киргизия",
    "монголия": "монголия",
    "куба": "куба",
    "сан-томе и принсипи": "сан-томе-и-принсипи",
    "бенин": "бенин",
    "мозамбик": "мозамбик",
    "мадагаскар": "мадагаскар",
    "узбекистан": "узбекистан",
    "габон": "габон",
    "таджикистан": "таджикистан",
    "буркина-фасо": "буркина-фасо",
    "того": "того",
    "гвинея": "гвинея",
    "мавритания": "мавритания",
    "кот-д’ивуар": "кот-дивуар",
    "экваториальная гвинея": "экватор-гвинея",
    "сенегал": "сенегал",
    "индия": "индия",
    "камбоджа": "камбоджа",
    "чад": "чад",
    "нигер": "нигер",
    "бутан": "бутан",
    "мали": "мали",
    "коморы": "коморы",
    "египет": "египет",
    "гвинея-бисау": "гвинея-бисау",
    "ангола": "ангола",
    "цар": "цар",
    "иордания": "иордания",
    "алжир": "алжир",
    "вьетнам": "вьетнам",
    "джибути": "джибути",
    "гаити": "гаити",
    "лаос": "лаос",
    "туркменистан": "туркменистан",
    "камерун": "камерун",
    "либерия": "либерия",
    "бурунди": "бурунди",
    "нигерия": "нигерия",
    "эфиопия": "эфиопия",
    "южный судан": "южный-судан",
    "иран": "иран",
    "судан": "судан",
    "ливан": "ливан",
    "демократическая республика конго": "дем-респ-конго",
    "мьянма": "мьянма",
    "шри-ланка": "шри-ланка",
    "косово": "косово",
    "эритрея": "эритрея",
    "ливия": "ливия",
    "северная корея": "северная-корея",
    "непал": "непал",
    "бангладеш": "бангладеш",
    "государство палестина": "гос-палестина",
    "сомали": "сомали",
    "пакистан": "пакистан",
    "йемен": "йемен",
    "ирак": "ирак",
    "сирия": "сирия",
    "афганистан": "афганистан",
    "соединённые штаты америки": "сша",
    "чехия": "чешская-республика",
    "объединенные арабские эмираты": "оаэ",
    "россия": "рф",
    "российская федерация": "рф",
    "юар": "южная-африка",
    "белоруссия": "беларусь",
    "конго": "дем-респ-конго",
    "шриланка": "шри-ланка",
    "палестина": "гос-палестина",
    "south korea": "south-korea",
    "united kingdom": "united-kingdom",
    "uk": "united-kingdom",
    "new zealand": "new-zealand",
    "united states of america": "united-states-of-america",
    "usa": "united-states-of-america",
    "czech republic": "czech-republic",
    "united arab emirates": "united-arab-emirates",
    "uae": "united-arab-emirates",
    "san marino": "san-marino",
    "hong kong": "hong-kong",
    "vatican": "vatican-city",
    "saint kitts and nevis": "saint-kitts-and-nevis",
    "st. vincent and the grenadines": "st-vincent-and-the-grenadines",
    "antigua and barbuda": "antigua-and-barbuda",
    "trinidad and tobago": "trinidad-and-tobago",
    "costa rica": "costa-rica",
    "saint lucia": "saint-lucia",
    "el salvador": "el-salvador",
    "solomon islands": "solomon-islands",
    "north macedonia": "north-macedonia",
    "marshall islands": "marshall-islands",
    "bosnia and herzegovina": "bosnia-and-herzegovina",
    "south africa": "south-africa",
    "papua new guinea": "papua-new-guinea",
    "saudi arabia": "saudi-arabia",
    "dominican republic": "dominican-republic",
    "cape verde": "cape-verde",
    "sierra leone": "sierra-leone",
    "sao tome and principe": "sao-tome-and-principe",
    "burkina faso": "burkina-faso",
    "cote d’ivoire (ivory coast)": "cote-divoire-ivory-coast",
    "equatorial guinea": "equatorial-guinea",
    "central african republic": "central-african-republic",
    "south sudan": "south-sudan",
    "congo (dem. rep.)": "congo-dem-rep",
    "myanmar": "myanmar-burma",
    "sri lanka": "sri-lanka",
    "north korea": "north-korea",
    "palestinian territories": "palestinian-territories",
    "palestina": "palestinian-territories"
}


def visaAdvisory(destination: str, citizenship: str, lang: str):
    passport = citizenship.lower()
    to = destination.lower()
    if passport == to:
        if lang=="eng":
            return "You are already here"
        if lang == "ru":
            return "Вы уже тут"
    if dictionary.get(destination) is not None:
        to = dictionary.get(destination)
    if dictionary.get(citizenship) is not None:
        passport = dictionary.get(citizenship)

    passport_link_eng = f"https://visaindex.com/country/{passport}-passport-ranking/"
    passport_link_ru = f"https://visaindex.com/ru/страна/{passport}-рейтинг-паспорта/"

    url = {
        'ru': passport_link_ru,
        'eng': passport_link_eng
    }

    dict = {}

    response = requests.get(url[f'{lang}'])
    soup = BeautifulSoup(response.text, 'lxml')

    data = soup.find_all("div", class_="col-title text-secondary font-weight-bold display-8")
    data2 = soup.find_all("div", class_="list-group borderLight bg-white")

    for i in range(len(data)):
        element = re.sub('[\t\r\n]', '', data[i].text)
        countries = data2[i].find_all("span", class_="country-name")
        for e in countries:
            country_element = re.sub('[\t\r\n]', '', e.text).lower()
            dict.setdefault(element, [])
            dict[element].append(country_element)

    for key in dict:
        for v in dict[key]:
            if v == to or dictionary.get(v) == to:
                return key
